<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EasyWin — Invest. Spin. Earn.</title>
  <meta name="description" content="EasyWin demo front-end — promo wheel centered, dashboard, deposit, withdraw, referral, newsletter, login/register (front-end only).">
  <style>
    :root{
      --bg:#031026;
      --accent:#0a7fe6;
      --accent-2:#063a78;
      --glass: rgba(255,255,255,0.03);
      --muted: rgba(255,255,255,0.78);
      --muted-2: rgba(255,255,255,0.45);
      --success:#36d07f;
      --danger:#ff6b6b;
      --card:#071827;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    }
    html,body{height:100%;margin:0;background:
      radial-gradient(900px 520px at 12% 12%, rgba(10,127,230,0.055), transparent),
      radial-gradient(700px 420px at 88% 88%, rgba(6,58,120,0.055), transparent),
      var(--bg);
      color:#e6f7ff;-webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;}

    /* background */
    .bg-canvas{position:fixed;inset:0;z-index:0;overflow:hidden;pointer-events:none}
    .bubble{position:absolute;border-radius:50%;mix-blend-mode:screen;opacity:.12;filter:blur(6px);
      background: radial-gradient(circle at 30% 30%, rgba(10,127,230,0.95), rgba(6,58,120,0.6));
      box-shadow:0 0 18px rgba(10,127,230,0.15);animation:float linear infinite;}
    @keyframes float{from{transform:translateY(0) rotate(0deg)}to{transform:translateY(-140vh) rotate(360deg)}}
    .star{position:absolute;width:2px;height:2px;background:rgba(255,255,255,0.95);border-radius:50%;filter:blur(0.6px);opacity:0.9;animation:twinkle 6s infinite;}
    @keyframes twinkle{0%{opacity:0.2}50%{opacity:1}100%{opacity:0.2}}

    /* layout */
    .wrap{position:relative;z-index:2;max-width:1200px;margin:20px auto;padding:18px}
    header{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:64px;height:64px;border-radius:12px;background:linear-gradient(135deg,var(--accent),var(--accent-2));display:flex;align-items:center;justify-content:center;font-weight:900;color:#fff;font-size:20px}
    .brand h1{margin:0;font-size:18px}
    nav.desktop{display:flex;gap:12px;align-items:center}
    nav.desktop a{color:var(--muted);font-weight:700;cursor:pointer}
    .cta{background:linear-gradient(90deg,var(--accent),#1aa1ff);padding:10px 16px;border-radius:10px;color:#021426;font-weight:800;cursor:pointer}
    .hamburger{display:none;background:transparent;border:0;color:var(--muted);font-size:20px;padding:8px;border-radius:8px}
    @media(max-width:920px){nav.desktop{display:none}.hamburger{display:inline-flex}}
    .mobile-nav{display:none;position:fixed;right:12px;top:72px;background:linear-gradient(180deg, rgba(6,58,120,0.95), rgba(6,58,120,0.85));padding:14px;border-radius:12px;box-shadow:0 10px 40px rgba(0,0,0,0.6)}
    .mobile-nav a{display:block;padding:8px 6px;color:#e6f5ff}

    main{display:grid;grid-template-columns:1fr 400px;gap:26px;margin-top:18px}
    @media(max-width:1100px){main{grid-template-columns:1fr}}
    .card{background:linear-gradient(180deg,var(--card), rgba(0,0,0,0.35));border-radius:14px;padding:16px;box-shadow:0 10px 40px rgba(0,0,0,0.6);border:1px solid rgba(255,255,255,0.03)}
    h2{margin:0;font-size:20px}
    p.lead{color:var(--muted-2);margin-top:8px}

    /* center spin CTA (floating center) */
    .center-cta{
      position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);z-index:40;
      display:flex;flex-direction:column;align-items:center;gap:12px;
    }
    .spin-big{
      width:140px;height:140px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,var(--accent),var(--accent-2));box-shadow:0 20px 60px rgba(10,127,230,0.18);cursor:pointer;font-weight:900;font-size:18px;color:#021426;border:none;
    }
    .spin-hint{color:var(--muted-2);font-size:13px;text-align:center}

    /* wheel modal */
    .modal-backdrop{position:fixed;inset:0;background:linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.4));display:flex;align-items:center;justify-content:center;z-index:60;backdrop-filter: blur(2px)}
    .modal{width:94%;max-width:820px;background:linear-gradient(180deg,#051226,#0c2940);border-radius:14px;padding:18px;box-shadow:0 24px 90px rgba(0,0,0,0.8);border:1px solid rgba(255,255,255,0.04)}
    .wheel{width:380px;height:380px;border-radius:50%;position:relative;overflow:visible;background:conic-gradient(#07335a 0 20%, #0a7fe6 20% 40%, #07335a 40% 60%, #0a7fe6 60% 80%, #07335a 80% 100%);display:flex;align-items:center;justify-content:center;box-shadow:0 12px 50px rgba(0,0,0,0.8)}
    .wheel .center{width:140px;height:140px;border-radius:50%;display:flex;align-items:center;justify-content:center;background:linear-gradient(135deg,#041a2b,#07324f);font-weight:900;color:#dff3ff;box-shadow:inset 0 -8px 20px rgba(0,0,0,0.6);font-size:18px}
    .pointer{position:absolute;top:-18px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:22px solid transparent;border-right:22px solid transparent;border-bottom:34px solid #ffd74d;border-radius:3px;z-index:5;filter:drop-shadow(0 6px 12px rgba(0,0,0,0.6))}

    /* forms & inputs */
    input,textarea,select{padding:10px;border-radius:8px;border:1px solid rgba(255,255,255,0.04);background:transparent;color:#eaf7ff}
    .muted{color:var(--muted-2)}
    .note{font-size:13px;color:var(--muted-2)}
    button{padding:10px 14px;border-radius:9px;border:0;background:var(--accent);color:#021426;font-weight:800;cursor:pointer}
    button.ghost{background:transparent;color:var(--muted);border:1px solid rgba(255,255,255,0.04)}

    /* small utilities */
    .flex{display:flex;gap:10px;align-items:center}
    .stack{display:flex;flex-direction:column;gap:8px}
    .hidden{display:none}

    /* responsive */
    @media(max-width:700px){
      .wheel{width:300px;height:300px}
      .wheel .center{width:110px;height:110px;font-size:16px}
      .center-cta{display:none} /* don't show floating CTA on tiny screens */
    }

    /* admin quick table */
    table{width:100%;border-collapse:collapse;font-size:13px}
    table th,table td{padding:8px;border-bottom:1px solid rgba(255,255,255,0.03);text-align:left;color:var(--muted-2)}
    .pill{padding:6px 8px;border-radius:8px;background:rgba(255,255,255,0.02);font-weight:700}
  </style>
</head>
<body>
  <div class="bg-canvas" id="bg"></div>

  <div class="wrap" id="app">
    <header>
      <div class="brand">
        <div class="logo">EW</div>
        <div>
          <h1>EasyWin</h1>
          <div class="muted">Invest. Spin. Earn.</div>
        </div>
      </div>

      <nav class="desktop" aria-label="Main navigation">
        <a onclick="navTo('home')">Home</a>
        <a onclick="navTo('dashboard')">Dashboard</a>
        <a onclick="navTo('deposit')">Deposit</a>
        <a onclick="navTo('withdraw')">Withdraw</a>
        <a onclick="navTo('referral')">Referral</a>
        <a onclick="navTo('support')">Support</a>
        <a onclick="navTo('faq')">FAQ</a>
        <a onclick="navTo('login')">Login</a>
        <div class="cta" id="openSpinBtn" onclick="openWheel()">Spin Now</div>
      </nav>

      <button class="hamburger" id="hamburger" aria-expanded="false">☰</button>
      <div class="mobile-nav hidden" id="mobileNav" role="navigation" aria-hidden="true">
        <a onclick="navTo('home')">Home</a>
        <a onclick="navTo('dashboard')">Dashboard</a>
        <a onclick="navTo('deposit')">Deposit</a>
        <a onclick="navTo('withdraw')">Withdraw</a>
        <a onclick="navTo('referral')">Referral</a>
        <a onclick="navTo('support')">Support</a>
        <a onclick="navTo('faq')">FAQ</a>
        <a onclick="navTo('login')">Login</a>
        <a onclick="openWheel()">Spin Now</a>
      </div>
    </header>

    <main id="content" style="margin-top:18px">
      <!-- HOME -->
      <section id="home" class="card-section">
        <div class="card">
          <h2>Welcome to EasyWin</h2>
          <p class="lead">Try the centered Spin wheel, view dashboard, deposit or withdraw (demo). Replace payment placeholders with your real info after integrating a secure backend and payment provider.</p>
          <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
            <button onclick="openWheel()">Open Spin (Popup)</button>
            <button onclick="navTo('deposit')" class="ghost">Go to Deposit</button>
            <button onclick="navTo('dashboard')" class="ghost">Open Dashboard</button>
          </div>
        </div>

        <div class="card" style="margin-top:16px">
          <h2>Latest News</h2>
          <div style="margin-top:10px">
            <article style="margin-bottom:8px">
              <strong>EasyWin Launch (Demo)</strong>
              <div class="note">This is a front-end demo. Replace newsletter logic with an API to collect emails safely.</div>
            </article>
            <article>
              <strong>Security Reminder</strong>
              <div class="note">Integrate KYC & backend verification before live deposits. Logs & webhooks are required.</div>
            </article>
          </div>
        </div>
      </section>

      <!-- DASHBOARD -->
      <section id="dashboard" class="card-section hidden">
        <div class="card">
          <h2>Dashboard</h2>
          <p class="note">Summary is based on local demo records. In production, pull this from your server & DB.</p>
          <div style="display:flex;gap:12px;margin-top:12px;flex-wrap:wrap">
            <div style="flex:1;min-width:140px" class="card">
              <div class="muted">Balance (demo)</div>
              <div style="font-size:20px;font-weight:900;margin-top:6px" id="summaryBalance">$0</div>
            </div>
            <div style="flex:1;min-width:140px" class="card">
              <div class="muted">Pending Deposits</div>
              <div style="font-size:20px;font-weight:900;margin-top:6px" id="summaryPending">0</div>
            </div>
            <div style="flex:1;min-width:140px" class="card">
              <div class="muted">Withdraw Requests</div>
              <div style="font-size:20px;font-weight:900;margin-top:6px" id="summaryWithdraws">0</div>
            </div>
          </div>

          <div style="margin-top:12px">
            <h3 style="margin-bottom:8px">Recent Activity</h3>
            <div id="activityList" class="stack"></div>
          </div>

          <div style="margin-top:12px" class="admin-bar">
            <div class="note">Admin tools (demo)</div>
            <div style="display:flex;gap:8px">
              <button onclick="viewLocalRecords()" class="ghost">View Local Records</button>
              <button onclick="exportLocalRecords()" class="ghost">Export</button>
              <button onclick="clearDemoData()" class="ghost">Clear Demo Data</button>
            </div>
          </div>
        </div>
      </section>

      <!-- DEPOSIT -->
      <section id="deposit" class="card-section hidden">
        <div class="card">
          <h2>Deposit</h2>
          <p class="note">Choose Bank or Crypto. This demo displays your details only. For real payments, integrate a payment provider on the server and use webhooks to confirm deposits.</p>

          <div style="margin-top:10px" class="flex">
            <button id="bankBtn">Bank Transfer</button>
            <button id="cryptoBtn" class="ghost">Crypto</button>
          </div>

          <div id="bankDetails" class="detail-box hidden" style="margin-top:12px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="font-weight:800">Bank Account</div>
                <div class="note">Bank: <strong id="bankName">REPLACE_WITH_BANK</strong></div>
                <div class="note">Acct name: <strong id="bankHolder">REPLACE_WITH_ACCOUNT_NAME</strong></div>
                <div class="note">Acct #: <strong id="bankAcct">REPLACE_WITH_ACCOUNT_NUMBER</strong></div>
              </div>
              <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
                <button class="copy-btn" data-copy="#bankAcct">Copy Acct #</button>
                <button class="copy-btn" data-copy="#bankHolder">Copy Name</button>
              </div>
            </div>
            <div class="note" style="margin-top:8px">Important: Confirm transfers on your backend via bank APIs or manual confirmation before crediting accounts.</div>
          </div>

          <div id="cryptoDetails" class="detail-box hidden" style="margin-top:12px">
            <div style="display:flex;justify-content:space-between;align-items:center">
              <div>
                <div style="font-weight:800">Crypto Wallets</div>
                <div class="note">BTC: <span id="btcAddr">REPLACE_WITH_BTC_ADDR</span></div>
                <div class="note">ETH: <span id="ethAddr">REPLACE_WITH_ETH_ADDR</span></div>
                <div class="note">USDT (ERC20): <span id="usdtAddr">REPLACE_WITH_USDT_ADDR</span></div>
              </div>
              <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
                <button class="copy-btn" data-copy="#btcAddr">Copy BTC</button>
                <button class="copy-btn" data-copy="#ethAddr">Copy ETH</button>
                <button class="copy-btn" data-copy="#usdtAddr">Copy USDT</button>
              </div>
            </div>
            <div class="note" style="margin-top:8px">Use unique deposit addresses in production; monitor blockchain confirmations via webhooks.</div>
          </div>

          <div style="margin-top:12px">
            <label style="font-weight:800">Amount (USD)</label><br/>
            <input id="depositAmount" type="number" min="10" step="10" placeholder="e.g., 100" style="width:100%;margin-top:8px" />
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="depositProceed">Proceed</button>
              <button id="depositClear" class="ghost">Clear</button>
            </div>
            <div id="depositMsg" style="margin-top:8px"></div>
          </div>

        </div>
      </section>

      <!-- WITHDRAW -->
      <section id="withdraw" class="card-section hidden">
        <div class="card">
          <h2>Withdraw</h2>
          <p class="note">Submit a withdraw request — in production this must be verified & processed by the backend/admin.</p>
          <div style="margin-top:8px">
            <label style="font-weight:700">Amount (USD)</label>
            <input id="withdrawAmount" type="number" min="1" step="1" placeholder="e.g., 100" style="width:100%;margin-top:8px" />
          </div>
          <div style="margin-top:8px">
            <label style="font-weight:700">Destination (Bank or Crypto address)</label>
            <input id="withdrawDest" type="text" placeholder="Account # or Wallet address" style="width:100%;margin-top:8px" />
          </div>
          <div style="display:flex;gap:8px;margin-top:8px">
            <button id="withdrawSubmit">Request Withdraw</button>
            <button id="withdrawClear" class="ghost">Clear</button>
          </div>
          <div id="withdrawMsg" style="margin-top:8px"></div>
        </div>
      </section>

      <!-- REFERRAL -->
      <section id="referral" class="card-section hidden">
        <div class="card">
          <h2>Referral Program</h2>
          <p class="note">Share your referral link; when your referees deposit, you get a bonus. Implement server-side tracking & unique codes in production.</p>
          <div style="margin-top:12px">
            <label>Your referral code</label>
            <div style="display:flex;gap:8px;margin-top:6px;align-items:center">
              <input id="refCode" type="text" readonly style="flex:1" />
              <button id="copyRef">Copy</button>
            </div>
            <div class="note" style="margin-top:8px">Example link: https://yourdomain.com/?ref=YOURCODE — handle referral attribution server-side for accuracy.</div>
          </div>
        </div>
      </section>

      <!-- SUPPORT -->
      <section id="support" class="card-section hidden">
        <div class="card">
          <h2>Support</h2>
          <p class="note">Submit a support message; production should send this to ticketing/email backend (e.g., Zendesk, Freshdesk).</p>
          <div style="margin-top:12px">
            <label>Subject</label>
            <input id="supportSubject" type="text" placeholder="Short description" />
            <label style="margin-top:8px">Message</label>
            <textarea id="supportMsg" placeholder="Describe your issue..." style="width:100%;"></textarea>
            <div style="display:flex;gap:8px;margin-top:8px">
              <button id="supportSubmit">Send</button>
              <button id="supportClear" class="ghost">Clear</button>
            </div>
            <div id="supportNote" style="margin-top:8px"></div>
          </div>
        </div>
      </section>

      <!-- FAQ -->
      <section id="faq" class="card-section hidden">
        <div class="card">
          <h2>FAQ</h2>
          <details style="margin-top:10px"><summary>How does the Spin Promo work?</summary><div class="note" style="margin-top:8px">This demo shows the wheel. In production, spins, eligibility, and payouts must be validated server-side and include clear T&Cs.</div></details>
          <details style="margin-top:8px"><summary>How do I deposit?</summary><div class="note" style="margin-top:8px">Use the Deposit page and send funds to the displayed account/address. Production must verify receipts before crediting balances.</div></details>
        </div>
      </section>

      <!-- LOGIN / REGISTER -->
      <section id="login" class="card-section hidden">
        <div class="card">
          <h2>Login / Register (demo)</h2>
          <div style="display:flex;gap:12px;margin-top:8px">
            <div style="flex:1">
              <h3 style="margin:0 0 8px 0">Login</h3>
              <input id="loginEmail" type="email" placeholder="email" style="width:100%;margin-top:6px" />
              <input id="loginPass" type="password" placeholder="password" style="width:100%;margin-top:8px" />
              <div style="display:flex;gap:8px;margin-top:8px">
                <button id="loginBtn">Login</button>
                <button id="demoFill" class="ghost">Demo fill</button>
              </div>
              <div id="loginMsg" style="margin-top:8px"></div>
            </div>
            <div style="flex:1">
              <h3 style="margin:0 0 8px 0">Register</h3>
              <input id="regEmail" type="email" placeholder="email" style="width:100%;margin-top:6px" />
              <input id="regPass" type="password" placeholder="password" style="width:100%;margin-top:8px" />
              <div style="display:flex;gap:8px;margin-top:8px">
                <button id="regBtn">Register</button>
              </div>
              <div id="regMsg" style="margin-top:8px"></div>
            </div>
          </div>
        </div>
      </section>

    </main>

    <footer style="margin-top:18px">
      <div class="card">
        <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap">
          <div>&copy; <strong>EasyWin</strong> — Demo front-end</div>
          <div class="note">Replace placeholders and connect a secure backend & payment gateway before going live.</div>
        </div>
      </div>
    </footer>
  </div>

  <!-- Center spin CTA (floating) -->
  <div class="center-cta" id="centerCta">
    <button class="spin-big" id="centerSpin">Spin</button>
    <div class="spin-hint muted">Spin the wheel to see promos</div>
  </div>

  <!-- Wheel modal -->
  <div id="wheelModal" class="modal-backdrop hidden" aria-hidden="true">
    <div class="modal">
      <div style="display:flex;justify-content:space-between;align-items:center">
        <div>
          <h2 style="margin:0">Spin Promo</h2>
          <div class="note" style="margin-top:6px">Qualifying deposit tiers are: $100 → $500, $200 → $1,000, $500 → $3,000, $1,000 → $6,000, $2,000 → $12,000, $10,000 → $60,000.</div>
        </div>
        <div style="display:flex;gap:8px">
          <button class="ghost" id="closeWheel">Close</button>
        </div>
      </div>

      <div style="display:flex;gap:18px;align-items:center;margin-top:14px;flex-wrap:wrap">
        <div style="flex:1;display:flex;align-items:center;justify-content:center;min-width:340px">
          <div style="position:relative">
            <div class="pointer" aria-hidden="true"></div>
            <div class="wheel" id="wheel">
              <div class="center">SPIN</div>
            </div>
          </div>
        </div>

        <div style="flex:1;min-width:260px">
          <div style="display:flex;flex-direction:column;gap:8px">
            <label>Enter deposit amount (e.g., 100)</label>
            <input id="spinAmount" type="number" min="50" step="50" placeholder="Enter deposit amount" />
            <div style="display:flex;gap:8px">
              <button id="spinBtn">Spin</button>
              <button id="spinClose" class="ghost">Close</button>
            </div>
            <div id="spinResultMsg" style="margin-top:8px"></div>

            <div style="margin-top:14px">
              <h4 style="margin:0 0 8px 0">Promo Tiers</h4>
              <div class="promo-list">
                <div class="promo-item"><div>$100</div><div class="right">$500</div></div>
                <div class="promo-item"><div>$200</div><div class="right">$1,000</div></div>
                <div class="promo-item"><div>$500</div><div class="right">$3,000</div></div>
                <div class="promo-item"><div>$1,000</div><div class="right">$6,000</div></div>
                <div class="promo-item"><div>$2,000</div><div class="right">$12,000</div></div>
                <div class="promo-item"><div>$10,000</div><div class="right">$60,000</div></div>
              </div>
            </div>

          </div>
        </div>
      </div>

    </div>
  </div>

<script>
/* ------------------------
   Background visuals
   ------------------------ */
(function bg(){
  const bg = document.getElementById('bg');
  const sizes = [24,36,48,72,100,14,20,60];
  for(let i=0;i<16;i++){
    const b = document.createElement('div'); b.className='bubble';
    const s = sizes[Math.floor(Math.random()*sizes.length)];
    b.style.width = s+'px'; b.style.height = s+'px';
    b.style.left = Math.random()*100+'%';
    b.style.top = 80 + Math.random()*20 + '%';
    b.style.opacity = 0.04 + Math.random()*0.12;
    b.style.animationDuration = (30 + Math.random()*70) + 's';
    bg.appendChild(b);
  }
  for(let i=0;i<80;i++){
    const st = document.createElement('div'); st.className='star';
    st.style.left = Math.random()*100 + '%';
    st.style.top = Math.random()*85 + '%';
    st.style.opacity = 0.2 + Math.random()*0.9;
    st.style.animationDuration = (4 + Math.random()*8)+'s';
    bg.appendChild(st);
  }
})();

/* ------------------------
   Navigation helpers
   ------------------------ */
function showSection(id){
  document.querySelectorAll('.card-section').forEach(s => s.classList.add('hidden'));
  const el = document.getElementById(id);
  if(el) el.classList.remove('hidden');
  // scroll to top for small devices
  window.scrollTo({top:0, behavior:'smooth'});
}
function navTo(id){ showSection(id); }

/* initialize home view */
showSection('home');

/* mobile nav toggle */
const hamburger = document.getElementById('hamburger'), mobileNav = document.getElementById('mobileNav');
hamburger.addEventListener('click', () => {
  mobileNav.classList.toggle('hidden');
  const exp = hamburger.getAttribute('aria-expanded') === 'true';
  hamburger.setAttribute('aria-expanded', String(!exp));
});

/* center CTA */
const centerSpin = document.getElementById('centerSpin');
centerSpin.addEventListener('click', openWheel);

/* support mobile openSpin link */
document.getElementById('openSpinBtn').addEventListener('click', openWheel);

/* ------------------------
   Wheel logic
   ------------------------ */
/* segments (10 segments) */
const segments = [
  {label:'$100 → $500', deposit:100, prize:500},
  {label:'NO PRIZE', deposit:0, prize:0},
  {label:'$200 → $1,000', deposit:200, prize:1000},
  {label:'NO PRIZE', deposit:0, prize:0},
  {label:'$500 → $3,000', deposit:500, prize:3000},
  {label:'$1,000 → $6,000', deposit:1000, prize:6000},
  {label:'$2,000 → $12,000', deposit:2000, prize:12000},
  {label:'NO PRIZE', deposit:0, prize:0},
  {label:'$10,000 → $60,000', deposit:10000, prize:60000},
  {label:'NO PRIZE', deposit:0, prize:0}
];

/* draw labels on wheel */
(function drawWheelLabels(){
  const wheel = document.getElementById('wheel');
  const count = segments.length;
  for(let i=0;i<count;i++){
    const d = document.createElement('div');
    d.style.position='absolute';
    d.style.width='50%'; d.style.height='50%'; d.style.left='50%'; d.style.top='50%';
    d.style.transformOrigin='0% 0%';
    d.style.transform = 'rotate(' + (i*(360/count)) + 'deg) translate(-8px, -190px)';
    d.style.color='#eaf7ff'; d.style.fontSize='13px'; d.style.fontWeight='800';
    d.style.textShadow='0 2px 8px rgba(0,0,0,0.6)';
    d.innerText = segments[i].label;
    wheel.appendChild(d);
  }
})();

function openWheel(){
  const modal = document.getElementById('wheelModal');
  modal.classList.remove('hidden'); modal.setAttribute('aria-hidden','false');
  // optionally auto-focus amount input
  setTimeout(()=>document.getElementById('spinAmount').focus(),120);
}
function closeWheel(){
  const modal = document.getElementById('wheelModal');
  modal.classList.add('hidden'); modal.setAttribute('aria-hidden','true');
  // reset wheel transform
  const wheelEl = document.getElementById('wheel');
  wheelEl.style.transition='transform 0s'; wheelEl.style.transform='rotate(0deg)';
}
document.getElementById('closeWheel').addEventListener('click', closeWheel);
document.getElementById('spinClose').addEventListener('click', closeWheel);

/* pick segment based on amount (biased) */
function pickSegmentIndex(amount){
  // favor matching deposit tiers
  for(let i=0;i<segments.length;i++){
    if(segments[i].deposit === amount && Math.random() < 0.85) return i;
  }
  // otherwise weighted random: NO PRIZE heavier
  const list = [];
  segments.forEach((s,i)=>{
    const weight = s.prize>0 ? 2 : 6;
    for(let k=0;k<weight;k++) list.push(i);
  });
  return list[Math.floor(Math.random()*list.length)];
}

function rotateToIndex(index, spins=7){
  const wheelEl = document.getElementById('wheel');
  const anglePer = 360 / segments.length;
  const randomOffset = Math.random()*anglePer;
  const target = 360*spins - (index*anglePer + anglePer/2) - randomOffset;
  wheelEl.style.transition = 'transform 6s cubic-bezier(.08,.85,.1,1)';
  wheelEl.style.transform = `rotate(${target}deg)`;
}

/* spin button */
document.getElementById('spinBtn').addEventListener('click', () => {
  const amount = Number(document.getElementById('spinAmount').value);
  if(!amount || amount < 50){ alert('Enter a valid amount (e.g., 100)'); return; }
  const idx = pickSegmentIndex(amount);
  rotateToIndex(idx, 7);
  const spinBtn = document.getElementById('spinBtn');
  spinBtn.disabled = true; spinBtn.innerText = 'Spinning...';
  setTimeout(() => {
    spinBtn.disabled = false; spinBtn.innerText = 'Spin';
    const seg = segments[idx];
    const msg = document.getElementById('spinResultMsg');
    if(seg.prize > 0){
      msg.innerHTML = `<div style="font-weight:900;font-size:20px;color:var(--accent)">You won $${seg.prize.toLocaleString()}!</div>
                       <div class="note">Deposit $${seg.deposit.toLocaleString()} to claim (demo). Click "Proceed" on the Deposit page to record intent.</div>`;
      // pre-fill deposit amount for convenience:
      document.getElementById('depositAmount').value = seg.deposit;
      // save a small spin history record
      saveSpinRecord({deposit:seg.deposit, prize:seg.prize, won:true, createdAt:new Date().toISOString()});
    } else {
      msg.innerHTML = `<div class="note">No prize this time. Try again or deposit to increase your chances.</div>`;
      saveSpinRecord({deposit:amount, prize:0, won:false, createdAt:new Date().toISOString()});
    }
    // keep modal open so user can navigate
  }, 6200);
});

/* clicking big center spin button opens modal and sets focus */
document.getElementById('centerSpin').addEventListener('click', () => {
  openWheel();
});

/* save spin record in localStorage for demo */
function saveSpinRecord(rec){
  const arr = JSON.parse(localStorage.getItem('ew_spins')||'[]');
  arr.unshift(rec);
  localStorage.setItem('ew_spins', JSON.stringify(arr));
  updateDashboard();
}

/* ------------------------
   Deposit / Withdraw demo logic (localStorage)
   ------------------------ */
function saveDeposit(rec){
  const arr = JSON.parse(localStorage.getItem('ew_deposits')||'[]');
  arr.unshift(rec); localStorage.setItem('ew_deposits', JSON.stringify(arr));
  updateDashboard();
}
function saveWithdraw(rec){
  const arr = JSON.parse(localStorage.getItem('ew_withdraws')||'[]');
  arr.unshift(rec); localStorage.setItem('ew_withdraws', JSON.stringify(arr));
  updateDashboard();
}

/* deposit UI actions */
document.getElementById('bankBtn').addEventListener('click', () => {
  document.getElementById('bankDetails').classList.toggle('hidden');
  document.getElementById('cryptoDetails').classList.add('hidden');
});
document.getElementById('cryptoBtn').addEventListener('click', () => {
  document.getElementById('cryptoDetails').classList.toggle('hidden');
  document.getElementById('bankDetails').classList.add('hidden');
});
document.querySelectorAll('.copy-btn').forEach(btn => {
  btn.addEventListener('click', () => {
    const sel = btn.dataset.copy; const el = document.querySelector(sel);
    if(!el) return;
    navigator.clipboard.writeText(el.innerText).then(()=>{ const old = btn.innerText; btn.innerText='Copied'; setTimeout(()=>btn.innerText = old,1200); }).catch(()=>alert('Copy failed'));
  });
});

document.getElementById('depositProceed').addEventListener('click', () => {
  const amount = Number(document.getElementById('depositAmount').value);
  if(!amount || amount < 1){ document.getElementById('depositMsg').innerHTML = '<span style="color:var(--danger)">Enter valid amount.</span>'; return; }
  // ensure at least one method visible
  if(document.getElementById('bankDetails').classList.contains('hidden') && document.getElementById('cryptoDetails').classList.contains('hidden')){
    document.getElementById('depositMsg').innerHTML = '<div class="note">Select Bank or Crypto to see details.</div>'; return;
  }
  const method = document.getElementById('bankDetails').classList.contains('hidden') ? 'crypto' : 'bank';
  const rec = {id:genId(), amount, method, status:'pending', createdAt:new Date().toISOString()};
  saveDeposit(rec);
  document.getElementById('depositMsg').innerHTML = '<div style="color:var(--success)">Deposit intent saved (demo). Send funds to displayed address and confirm manually or via backend webhook.</div>';
});

document.getElementById('depositClear').addEventListener('click', () => {
  document.getElementById('depositAmount').value=''; document.getElementById('depositMsg').innerHTML='';
});

/* withdraw UI */
document.getElementById('withdrawSubmit').addEventListener('click', () => {
  const amount = Number(document.getElementById('withdrawAmount').value);
  const dest = document.getElementById('withdrawDest').value.trim();
  if(!amount || amount < 1 || !dest){ document.getElementById('withdrawMsg').innerHTML = '<div style="color:var(--danger)">Enter amount & destination.</div>'; return; }
  const rec = {id:genId(), amount, dest, status:'requested', createdAt:new Date().toISOString()};
  saveWithdraw(rec);
  document.getElementById('withdrawMsg').innerHTML = '<div style="color:var(--success)">Withdraw request recorded (demo). Process manually in admin backend.</div>';
});
document.getElementById('withdrawClear').addEventListener('click', () => {
  document.getElementById('withdrawAmount').value=''; document.getElementById('withdrawDest').value=''; document.getElementById('withdrawMsg').innerHTML='';
});

/* ------------------------
   Support form (demo)
   ------------------------ */
document.getElementById('supportSubmit').addEventListener('click', () => {
  const subj = document.getElementById('supportSubject').value.trim();
  const msg = document.getElementById('supportMsg').value.trim();
  if(!subj || !msg){ document.getElementById('supportNote').innerText = 'Enter subject and message.'; return; }
  const arr = JSON.parse(localStorage.getItem('ew_support')||'[]');
  arr.unshift({id:genId(), subject:subj, message:msg, createdAt:new Date().toISOString()});
  localStorage.setItem('ew_support', JSON.stringify(arr));
  document.getElementById('supportNote').innerText = 'Message recorded (demo). Admin should process via ticketing system.';
  document.getElementById('supportSubject').value=''; document.getElementById('supportMsg').value='';
});
document.getElementById('supportClear').addEventListener('click', () => { document.getElementById('supportSubject').value=''; document.getElementById('supportMsg').value=''; document.getElementById('supportNote').innerText=''; });

/* ------------------------
   Referral
   ------------------------ */
(function initRef(){
  let code = localStorage.getItem('ew_refcode');
  if(!code){ code = 'EW' + Math.random().toString(36).slice(2,8).toUpperCase(); localStorage.setItem('ew_refcode', code); }
  document.getElementById('refCode').value = code;
  document.getElementById('copyRef').addEventListener('click', () => {
    navigator.clipboard.writeText(location.origin + '/?ref=' + code).then(()=> alert('Referral link copied'));
  });
})();

/* ------------------------
   Login / Register (front-end demo)
   ------------------------ */
function getUsers(){ return JSON.parse(localStorage.getItem('ew_users')||'[]'); }
function saveUsers(u){ localStorage.setItem('ew_users', JSON.stringify(u)); }
document.getElementById('regBtn').addEventListener('click', () => {
  const email = document.getElementById('regEmail').value.trim();
  const pass = document.getElementById('regPass').value;
  if(!email || !pass){ document.getElementById('regMsg').innerText='Enter email & password'; return; }
  const users = getUsers();
  if(users.find(x=>x.email===email)){ document.getElementById('regMsg').innerText='Email exists'; return; }
  users.push({id:genId(), email, pass, balance:0, createdAt:new Date().toISOString()});
  saveUsers(users);
  document.getElementById('regMsg').innerText='Registered (demo). You can login now.';
  document.getElementById('regEmail').value=''; document.getElementById('regPass').value='';
});
document.getElementById('loginBtn').addEventListener('click', () => {
  const email = document.getElementById('loginEmail').value.trim();
  const pass = document.getElementById('loginPass').value;
  const users = getUsers();
  const u = users.find(x=>x.email===email && x.pass===pass);
  if(!u){ document.getElementById('loginMsg').innerText='Invalid credentials (demo).'; return; }
  localStorage.setItem('ew_session', JSON.stringify({userId:u.id, email:u.email}));
  document.getElementById('loginMsg').innerText='Logged in (demo).';
  updateDashboard();
});
document.getElementById('demoFill').addEventListener('click', () => {
  document.getElementById('loginEmail').value='demo@easywin.test'; document.getElementById('loginPass').value='password';
  const users = getUsers();
  if(!users.find(x=>x.email==='demo@easywin.test')){ users.push({id:genId(), email:'demo@easywin.test', pass:'password', balance:5000, createdAt:new Date().toISOString()}); saveUsers(users); }
});

/* ------------------------
   Newsletter (local)
   ------------------------ */
document.getElementById('subscribeBtn').addEventListener('click', () => {
  const e = document.getElementById('newsletterEmail');
  if(!e) return;
  const email = e.value.trim(); if(!email.includes('@')){ alert('Enter valid email'); return; }
  const list = JSON.parse(localStorage.getItem('ew_news')||'[]');
  if(list.includes(email)){ alert('Already subscribed'); return; }
  list.push(email); localStorage.setItem('ew_news', JSON.stringify(list));
  alert('Subscribed (demo). Replace with provider integration in production.');
  e.value='';
});

/* ------------------------
   Admin quick view & export
   ------------------------ */
function viewLocalRecords(){
  const deps = JSON.parse(localStorage.getItem('ew_deposits')||'[]');
  const wds = JSON.parse(localStorage.getItem('ew_withdraws')||'[]');
  const spins = JSON.parse(localStorage.getItem('ew_spins')||'[]');
  const support = JSON.parse(localStorage.getItem('ew_support')||'[]');
  const users = JSON.parse(localStorage.getItem('ew_users')||'[]');
  const news = JSON.parse(localStorage.getItem('ew_news')||'[]');
  const txt = {
    deposits:deps, withdraws:wds, spins:spins, support:support, users:users, newsletter:news
  };
  const w = window.open('', '_blank', 'width=900,height=700,scrollbars=yes');
  w.document.write('<pre style="white-space:pre-wrap;font-family:monospace;font-size:12px">'+escapeHtml(JSON.stringify(txt,null,2))+'</pre>');
}
function exportLocalRecords(){
  const data = {
    deposits: JSON.parse(localStorage.getItem('ew_deposits')||'[]'),
    withdraws: JSON.parse(localStorage.getItem('ew_withdraws')||'[]'),
    spins: JSON.parse(localStorage.getItem('ew_spins')||'[]'),
    support: JSON.parse(localStorage.getItem('ew_support')||'[]'),
    users: JSON.parse(localStorage.getItem('ew_users')||'[]'),
    newsletter: JSON.parse(localStorage.getItem('ew_news')||'[]')
  };
  const blob = new Blob([JSON.stringify(data,null,2)], {type:'application/json'});
  const url = URL.createObjectURL(blob); const a = document.createElement('a'); a.href = url; a.download = 'easywin_data.json'; a.click(); URL.revokeObjectURL(url);
}
function clearDemoData(){
  if(!confirm('Clear demo data (localStorage)?')) return;
  ['ew_deposits','ew_withdraws','ew_spins','ew_support','ew_users','ew_news','ew_session'].forEach(k=>localStorage.removeItem(k));
  alert('Cleared demo data.');
  updateDashboard();
}

/* ------------------------
   Dashboard update
   ------------------------ */
function updateDashboard(){
  // balance uses user session (demo)
  const session = JSON.parse(localStorage.getItem('ew_session')||'null');
  const users = JSON.parse(localStorage.getItem('ew_users')||'[]');
  const user = session && users.find(u=>u.id===session.userId);
  const bal = user ? (user.balance || 0) : 0;
  document.getElementById('summaryBalance').innerText = '$' + Number(bal).toLocaleString();
  const pending = JSON.parse(localStorage.getItem('ew_deposits')||'[]').length;
  document.getElementById('summaryPending').innerText = pending;
  const withdraws = JSON.parse(localStorage.getItem('ew_withdraws')||'[]').length;
  document.getElementById('summaryWithdraws').innerText = withdraws;
  // recent activity (spins + deposits + withdraws)
  const spins = JSON.parse(localStorage.getItem('ew_spins')||'[]').slice(0,6);
  const deposits = JSON.parse(localStorage.getItem('ew_deposits')||'[]').slice(0,6);
  const withdrawsList = JSON.parse(localStorage.getItem('ew_withdraws')||'[]').slice(0,6);
  const act = document.getElementById('activityList'); act.innerHTML='';
  spins.forEach(s=>{ const el = document.createElement('div'); el.className='note'; el.innerText = `[Spin] ${s.won?('Won $'+s.prize):('No prize')} — ${new Date(s.createdAt).toLocaleString()}`; act.appendChild(el); });
  deposits.forEach(d=>{ const el = document.createElement('div'); el.className='note'; el.innerText = `[Deposit] $${d.amount} — ${d.method} — ${new Date(d.createdAt).toLocaleString()}`; act.appendChild(el); });
  withdrawsList.forEach(wd=>{ const el = document.createElement('div'); el.className='note'; el.innerText = `[Withdraw] $${wd.amount} — to ${shorten(wd.dest)} — ${new Date(wd.createdAt).toLocaleString()}`; act.appendChild(el); });
}
updateDashboard();

/* ------------------------
   Utilities
   ------------------------ */
function genId(){ return 'id_' + Math.random().toString(36).slice(2,10); }
function escapeHtml(s){ return String(s).replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;'); }
function shorten(s, n=18){ if(!s) return ''; return s.length>n ? s.slice(0,n-3)+'...' : s; }

/* ------------------------
   Auto-open wheel on first visit (per your request) AND keep "Spin Now" in center
   - We'll auto-open only once per browser (localStorage flag)
   ------------------------ */
(function maybeAutoOpen(){
  try {
    const seen = localStorage.getItem('ew_seen_welcome');
    if(!seen){
      // show after a short delay so page loads nicely
      setTimeout(()=>{ openWheel(); localStorage.setItem('ew_seen_welcome','1'); }, 900);
    }
  } catch(e){}
})();

/* ------------------------
   Small keyboard shortcut: Ctrl+/ opens admin records view
   ------------------------ */
document.addEventListener('keydown', (e) => {
  if((e.ctrlKey || e.metaKey) && e.key === '/'){ e.preventDefault(); viewLocalRecords(); }
});

/* ------------------------
   On load, wire tiny helpers
   ------------------------ */
document.getElementById('spinAmount').addEventListener('keydown', (e) => { if(e.key==='Enter') document.getElementById('spinBtn').click(); });
document.getElementById('depositAmount').addEventListener('keydown', (e)=>{ if(e.key==='Enter') document.getElementById('depositProceed').click(); });

/* ------------------------
   Where to integrate a backend / payment provider (IMPORTANT)
   ------------------------
   - Replace REPLACE_WITH_... placeholders (bank & crypto addresses) after you have a secure backend & HTTPS.
   - For live fiat: use Stripe / Paystack / Flutterwave:
     1) Client requests a checkout session from your server (POST /create-checkout).
     2) Server creates session using provider SDK and returns session URL.
     3) Client redirects user to provider checkout.
     4) Provider sends webhook to your server on successful payment — server verifies, credits user.
   - For crypto: use Coinbase Commerce / NOWPayments / blockchair node:
     1) Create unique deposit addresses or checkout sessions server-side.
     2) Use webhooks or blockchain watchers to confirm transactions and update DB.
   - NEVER trust the client for confirming deposits or spins/payouts. Server must enforce eligibility, T&Cs, KYC & AML.
   ------------------------ */

</script>
</body>
</html>
